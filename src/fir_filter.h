#ifndef FIR_FILTER_H
#define FIR_FILTER_H

#include <complex.h>
#include <stdint.h>
#include <stdlib.h>

#define N_TAPS 137
static const float FILT[N_TAPS] = { 0.00006448984879187328F, 0.0001817947924724327F, 0.00039491906668758664F, 0.0007108488837184187F, 0.0011106422041704178F, 0.0015369155899683153F, 0.0018937446610476603F, 0.002059919467855908F, 0.0019160081616781221F, 0.0013807926198643624F, 0.00044785601903144F, -0.0007898043114602071F, -0.0021386911465999317F, -0.0033339954312544213F, -0.004097455151351057F, -0.004212352418281239F, -0.003595859902794442F, -0.0023454828311608106F, -0.0007399052310275609F, 0.0008145221219448863F, 0.001884514542037386F, 0.0021342061705929573F, 0.0014377766246860474F, -0.00005690768599047815F, -0.0019411491267344364F, -0.003641500137550939F, -0.004580382760294286F, -0.004358155240060348F, -0.002901603651390893F, -0.0005259471889638478F, 0.002120219758851951F, 0.004224539357139316F, 0.0050543041253042825F, 0.004203526595733725F, 0.0017639465163283522F, -0.0016453475122521967F, -0.005016634761029146F, -0.0072356435110508465F, -0.00743241939936848F, -0.00529478440902953F, -0.0012374692418724838F, 0.00364542716478797F, 0.007855187463278186F, 0.009928492432043051F, 0.008919671633064357F, 0.004773941436046384F, -0.001542176092863602F, -0.008224841844270232F, -0.013110654759927872F, -0.014331434510499196F, -0.010959218403956316F, -0.003435929859611057F, 0.006374715587261896F, 0.015577173951240919F, 0.021011767584514892F, 0.020213420567485277F, 0.01229679636351035F, -0.0015037896725472923F, -0.01783834460310451F, -0.03185012939189925F, -0.038283682651143174F, -0.032835760823993976F, -0.013404349723147397F, 0.019107505244255314F, 0.06067930099992444F, 0.1048284201857963F, 0.14391056714031464F, 0.17076848789209503F, 0.18033124039703805F, 0.17076848789209503F, 0.14391056714031464F, 0.1048284201857963F, 0.06067930099992444F, 0.019107505244255314F, -0.013404349723147397F, -0.032835760823993976F, -0.038283682651143174F, -0.03185012939189925F, -0.01783834460310451F, -0.0015037896725472923F, 0.01229679636351035F, 0.020213420567485277F, 0.021011767584514892F, 0.015577173951240919F, 0.006374715587261896F, -0.003435929859611057F, -0.010959218403956316F, -0.014331434510499196F, -0.013110654759927872F, -0.008224841844270232F, -0.001542176092863602F, 0.004773941436046384F, 0.008919671633064357F, 0.009928492432043051F, 0.007855187463278186F, 0.00364542716478797F, -0.0012374692418724838F, -0.00529478440902953F, -0.00743241939936848F, -0.0072356435110508465F, -0.005016634761029146F, -0.0016453475122521967F, 0.0017639465163283522F, 0.004203526595733725F, 0.0050543041253042825F, 0.004224539357139316F, 0.002120219758851951F, -0.0005259471889638478F, -0.002901603651390893F, -0.004358155240060348F, -0.004580382760294286F, -0.003641500137550939F, -0.0019411491267344364F, -0.00005690768599047815F, 0.0014377766246860474F, 0.0021342061705929573F, 0.001884514542037386F, 0.0008145221219448863F, -0.0007399052310275609F, -0.0023454828311608106F, -0.003595859902794442F, -0.004212352418281239F, -0.004097455151351057F, -0.0033339954312544213F, -0.0021386911465999317F, -0.0007898043114602071F, 0.00044785601903144F, 0.0013807926198643624F, 0.0019160081616781221F, 0.002059919467855908F, 0.0018937446610476603F, 0.0015369155899683153F, 0.0011106422041704178F, 0.0007108488837184187F, 0.00039491906668758664F, 0.0001817947924724327F, 0.00006448984879187328F };

#define N_FIR_FILT_250kFS_15kPA_19kST 191
static const float FIR_FILT_250kFS_15kPA_19kST[N_FIR_FILT_250kFS_15kPA_19kST] = { 0.000044219730495340614F, 0.00009440017413002246F, 0.00018365481566381955F, 0.000314099657926496F, 0.0004888737347517136F, 0.0007052772638324323F, 0.0009530618154668994F, 0.001213501937310202F, 0.0014596543220620815F, 0.0016580911975254515F, 0.001772185264006052F, 0.0017667596615661733F, 0.0016136092510598552F, 0.001297190984372922F, 0.0008195541472049096F, 0.00020354235282485188F, -0.0005066031610256816F, -0.0012477912293477878F, -0.001943943396882769F, -0.00251478878088645F, -0.0028866415213852177F, -0.0030037479174223553F, -0.0028384913862145285F, -0.0023986640082025623F, -0.0017302297502465027F, -0.0009145766054104768F, -0.00006000902620814281F, 0.0007118808025280118F, 0.001283360665884154F, 0.0015588594476816553F, 0.001481605191451303F, 0.0010457625891767785F, 0.000301574090541716F, -0.0006479550570090435F, -0.0016591971640395236F, -0.0025677034644882584F, -0.0032131562544198277F, -0.003465828593184935F, -0.0032503729137945982F, -0.002562689289902561F, -0.0014764994872995415F, -0.00013761807392919704F, 0.0012542869500616768F, 0.0024743875585363107F, 0.0033080964852317337F, 0.0035876984968087194F, 0.0032243131182875307F, 0.0022293060231395614F, 0.0007207561105883507F, -0.0010874563644707642F, -0.0029135440066924215F, -0.004449451207866056F, -0.005410406821700571F, -0.005584735973844371F, -0.004875586071167914F, -0.0033268844512126033F, -0.0011278522188292914F, 0.0014064950686490984F, 0.00387759706914003F, 0.005863192233064355F, 0.0069862331966464705F, 0.006982135774058983F, 0.005753020181664978F, 0.00339881578041101F, 0.00021810770475836572F, -0.0033240087439066236F, -0.006658563768166884F, -0.009198145015204788F, -0.010433066286096221F, -0.010023483549336699F, -0.00787209465450969F, -0.004163924710020362F, 0.0006360702272000808F, 0.005831057067516668F, 0.010582242431390191F, 0.014030521700937876F, 0.01543312771302555F, 0.01429615792087495F, 0.010481576834571455F, 0.0042709935291500465F, -0.003627267347436748F, -0.012133396981147423F, -0.019910142427153145F, -0.025523793696773867F, -0.027632445479650606F, -0.025176691782452826F, -0.017546427721962674F, -0.004699384557322631F, 0.012787565557979339F, 0.033744553187915624F, 0.056512266250085125F, 0.07911237948405572F, 0.09946490871347209F, 0.11562550933926899F, 0.12601248946447888F, 0.1295942215312001F, 0.12601248946447888F, 0.11562550933926899F, 0.09946490871347209F, 0.07911237948405572F, 0.056512266250085125F, 0.033744553187915624F, 0.012787565557979339F, -0.004699384557322631F, -0.017546427721962674F, -0.025176691782452826F, -0.027632445479650606F, -0.025523793696773867F, -0.019910142427153145F, -0.012133396981147423F, -0.003627267347436748F, 0.0042709935291500465F, 0.010481576834571455F, 0.01429615792087495F, 0.01543312771302555F, 0.014030521700937876F, 0.010582242431390191F, 0.005831057067516668F, 0.0006360702272000808F, -0.004163924710020362F, -0.00787209465450969F, -0.010023483549336699F, -0.010433066286096221F, -0.009198145015204788F, -0.006658563768166884F, -0.0033240087439066236F, 0.00021810770475836572F, 0.00339881578041101F, 0.005753020181664978F, 0.006982135774058983F, 0.0069862331966464705F, 0.005863192233064355F, 0.00387759706914003F, 0.0014064950686490984F, -0.0011278522188292914F, -0.0033268844512126033F, -0.004875586071167914F, -0.005584735973844371F, -0.005410406821700571F, -0.004449451207866056F, -0.0029135440066924215F, -0.0010874563644707642F, 0.0007207561105883507F, 0.0022293060231395614F, 0.0032243131182875307F, 0.0035876984968087194F, 0.0033080964852317337F, 0.0024743875585363107F, 0.0012542869500616768F, -0.00013761807392919704F, -0.0014764994872995415F, -0.002562689289902561F, -0.0032503729137945982F, -0.003465828593184935F, -0.0032131562544198277F, -0.0025677034644882584F, -0.0016591971640395236F, -0.0006479550570090435F, 0.000301574090541716F, 0.0010457625891767785F, 0.001481605191451303F, 0.0015588594476816553F, 0.001283360665884154F, 0.0007118808025280118F, -0.00006000902620814281F, -0.0009145766054104768F, -0.0017302297502465027F, -0.0023986640082025623F, -0.0028384913862145285F, -0.0030037479174223553F, -0.0028866415213852177F, -0.00251478878088645F, -0.001943943396882769F, -0.0012477912293477878F, -0.0005066031610256816F, 0.00020354235282485188F, 0.0008195541472049096F, 0.001297190984372922F, 0.0016136092510598552F, 0.0017667596615661733F, 0.001772185264006052F, 0.0016580911975254515F, 0.0014596543220620815F, 0.001213501937310202F, 0.0009530618154668994F, 0.0007052772638324323F, 0.0004888737347517136F, 0.000314099657926496F, 0.00018365481566381955F, 0.00009440017413002246F, 0.000044219730495340614F };

#define N_FIR_FILT_250kFS_25kPA_32kST 191
static const float FIR_FILT_250kFS_25kPA_32kST[N_FIR_FILT_250kFS_25kPA_32kST] = { 0.00006408670511860349F, 0.0001574607229246175F, 0.00027131408184660934F, 0.0003231783812401294F, 0.00018703561108578763F, -0.00027365222762383107F, -0.0011401130386025054F, -0.002364263258985576F, -0.0037226880715269996F, -0.004835151278367996F, -0.0052654742452539266F, -0.004686599059010899F, -0.003052724522935274F, -0.000699248599433099F, 0.0016978975035378328F, 0.003323606371549229F, 0.0035339443459282338F, 0.0021589359055949973F, -0.0003427117848478855F, -0.0029790794866792827F, -0.0045766460590664585F, -0.004274463110803917F, -0.0019582610720434088F, 0.0015773960382499694F, 0.004860612137101669F, 0.006324378936208812F, 0.00502341925352845F, 0.00117007301607177F, -0.0037917646957822547F, -0.007681586760245092F, -0.008500284423380964F, -0.005402225652132115F, 0.0007299890140660254F, 0.007440250639184978F, 0.011620919732061426F, 0.010883793878649342F, 0.004802937480279566F, -0.00457388981983531F, -0.013296609074852866F, -0.017066938951562693F, -0.01320557626229058F, -0.0021883297064503914F, 0.012021215993195201F, 0.023184868945859208F, 0.02525053579759425F, 0.015169733609852078F, -0.005097002532780218F, -0.028363530597292814F, -0.04413732080367468F, -0.042178445482771616F, -0.01648043230704734F, 0.03183567783098518F, 0.09393004544554917F, 0.15537472053676948F, 0.20041528759133984F, 0.21694019975995274F, 0.20041528759133984F, 0.15537472053676948F, 0.09393004544554917F, 0.03183567783098518F, -0.01648043230704734F, -0.042178445482771616F, -0.04413732080367468F, -0.028363530597292814F, -0.005097002532780218F, 0.015169733609852078F, 0.02525053579759425F, 0.023184868945859208F, 0.012021215993195201F, -0.0021883297064503914F, -0.01320557626229058F, -0.017066938951562693F, -0.013296609074852866F, -0.00457388981983531F, 0.004802937480279566F, 0.010883793878649342F, 0.011620919732061426F, 0.007440250639184978F, 0.0007299890140660254F, -0.005402225652132115F, -0.008500284423380964F, -0.007681586760245092F, -0.0037917646957822547F, 0.00117007301607177F, 0.00502341925352845F, 0.006324378936208812F, 0.004860612137101669F, 0.0015773960382499694F, -0.0019582610720434088F, -0.004274463110803917F, -0.0045766460590664585F, -0.0029790794866792827F, -0.0003427117848478855F, 0.0021589359055949973F, 0.0035339443459282338F, 0.003323606371549229F, 0.0016978975035378328F, -0.000699248599433099F, -0.003052724522935274F, -0.004686599059010899F, -0.0052654742452539266F, -0.004835151278367996F, -0.0037226880715269996F, -0.002364263258985576F, -0.0011401130386025054F, -0.00027365222762383107F, 0.00018703561108578763F, 0.0003231783812401294F, 0.00027131408184660934F, 0.0001574607229246175F, 0.00006408670511860349F };

typedef struct fir_filter_r_t
{
    const float* taps;
    size_t num_taps;
    float* delay_line;
    size_t delay_line_num_samples;
} fir_filter_r_t;

typedef struct fir_filter_c_t
{
    const float* taps;
    size_t num_taps;
    float complex* delay_line;
    size_t delay_line_num_samples;
} fir_filter_c_t;

void init_filter_c(fir_filter_c_t* filter, const float* taps, size_t num_taps);

void apply_filter_c(fir_filter_c_t* filter, uint32_t decimation_factor, const float complex* input, size_t input_len, float complex** output, size_t* output_len);

void destroy_filter_c(fir_filter_c_t* filter);

void init_filter_r(fir_filter_r_t* filter, const float* taps, size_t num_taps);

void apply_filter_r(fir_filter_r_t* filter, uint32_t decimation_factor, const float* input, size_t input_len, float** output, size_t* output_len);

void destroy_filter_r(fir_filter_r_t* filter);

#endif //FIR_FILTER_H
